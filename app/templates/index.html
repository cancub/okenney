{% extends "layout.html" %}
{% import 'macros/misc.html' as widgets with context -%}
{% import 'macros/images/progressive/immediat.html' as images -%}
{% block head %}
<script src="/scripts/index.js"></script>
{{ widgets.css() }}
{{ images.css() }}
<link rel="stylesheet" href="/styles/index.css">
{{ widgets.js() }}
{{ images.js() }}
{% endblock %}

{% macro article_preview(details) -%}
{% set subpath = details.category + '/' + details.name %}
{% set article_path = 'articles/' + subpath + '.html' %}
{% set image_path = 'static/images/' + details.category + '/' + details.name %}
{% from article_path import titre, titre_fr, description, description_fr %}
<a class="article-preview" href="{{article_path}}">
  {{ images.image_progressive(image_path, 'image-recip')}}
  <div class="article-preview-text">
    <h2 class="article-preview-titre">{{ titre() }}</h2>
    <div class="article-preview-description">
      {{ description() }}
    </div>
  </div>
</a>
{%- endmacro %}

{% block content_column %}
<div id="MetadataPlusRecent" style="display:none">
{# Provide the data on the remainder of the files #}
{% for i in range(preload_count,total_count) %}
  <div title="{{ latest[i]['title'] }}"
       filepath="{{ latest[i]['filepath'] }}"
       imagepath="{{ latest[i]['image'] }}"
       descpath="{{ latest[i]['desc'] }}"></div>
{% endfor %}
</div>
<div class="refaconneur">
  <div class="articles-a-lune">
    <div class="principale">
      {{ article_preview(latest[0]) }}
    </div>
    <div class="deux-prochaine">
      {% for i in range(1, 3) %}
        {{ article_preview(latest[i]) }}
      {% endfor %}
    </div>
  </div>
  <div class="acceuil-stats">
    {{ widgets.batir_graphiques('vices', 250) }}
  </div>
  <div class="deuxieme-page">
  {% for i in range(3, 6) %}
    {{ article_preview(latest[i]) }}
  {% endfor %}
  </div>
</div>
<div class="articles-plus-vieux">
{% for i in range(6, preload_count) %}
  {{ article_preview(latest[i]) }}
{% endfor %}
</div>
{% endblock %}

{% block bas_de_page %}
<div>
  Icons made by <a href="https://www.freepik.com" title="Freepik">Freepik</a> from <a
    href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a>
</div>
{% endblock %}
